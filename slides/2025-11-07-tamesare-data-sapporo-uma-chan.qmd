---
title: GENDA ã®æ©Ÿæ¢°å­¦ç¿’ç’°å¢ƒã‚’ AWS ã‹ã‚‰ Databricks ã«ç§»è¡Œã—ã¦ã¿ãŸ
author:
  - name: uma-chan
categories:
  - "slides"
  - "genda"
date: 2025-11-07
date-modified: last-modified
description: |
  [ç™»å£‡è³‡æ–™] 2025-11-07 è©¦ã•ã‚ŒDATA SAPPORO #1
image: "/assets/common/icon_hhkb3_large.jpg"
format:
  revealjs:
    auto-stretch: false
    code-copy: true
    footer: "[2025-11-07 è©¦ã•ã‚ŒDATA SAPPORO #1](https://tamesaredatahokkaido.connpass.com/event/369741/)"
    include-in-header:
      - ../_includes/hatena-nocomment.html
    incremental: false
    scrollable: true
    slide-level: 3
    slide-number: true
    smaller: false
    theme:
      - simple
      - ../themes/font.scss
    title-prefix: ""
    toc-depth: 2
    toc: false
    height: 1080
    width: 1920
  gfm: default
subtitle: Databricks on AWS ã¯ã„ã„ã
---

## 1. ã¯ã˜ã‚ã«

### 1.1. è‡ªå·±ç´¹ä»‹

::: {style="display: flex; flex-direction: column; align-items: center; gap: 2em;"}

::: {style="text-align: left;"}

uma-chan (é¦¬æ¸¡ å¤§æ¨¹ / Mawatari Daiki)

:::

::: {style="text-align: left;"}

|                              |                                     |
| ---                          | ---                                 |
| Data Engineer/MLOps Engineer | [æ ªå¼ä¼šç¤¾GENDA](https://genda.jp/)  |

<!-- | Data Engineer | [PIVOTæ ªå¼ä¼šç¤¾](https://pivot.inc/) | -->

:::

::: {style="text-align: center;"}

å¥½ããªã‚‚ã®ãŸã¡

[![Vim](https://img.shields.io/badge/Vim-019733.svg?logo=vim&logoColor=white){height="1.5em" style="vertical-align: middle;"}](https://www.vim.org/) [![Neovim](https://img.shields.io/badge/Neovim-57A143.svg?logo=neovim&logoColor=white){height="1.5em" style="vertical-align: middle;"}](https://neovim.io/) [![tmux](https://img.shields.io/badge/tmux-1BB91F.svg?logo=tmux&logoColor=white){height="1.5em" style="vertical-align: middle;"}](https://github.com/tmux/tmux) [![Alacritty](https://img.shields.io/badge/Alacritty-F46D01.svg?logo=alacritty&logoColor=white){height="1.5em" style="vertical-align: middle;"}](https://alacritty.org/)

:::

::: {style="text-align: center;"}

[![GitHub](https://img.shields.io/badge/@i9wa4-181717.svg?logo=github&logoColor=white){height="1.5em" style="vertical-align: middle;"}](https://github.com/i9wa4) [![X](https://img.shields.io/badge/@i9wa4__-000000.svg?logo=x&logoColor=white){height="1.5em" style="vertical-align: middle;"}](https://x.com/i9wa4_) [![Website](https://img.shields.io/badge/ğŸ”—_i9wa4.github.io-4285F4.svg?logoColor=white){height="1.5em" style="vertical-align: middle;"}](https://i9wa4.github.io)

:::

:::

## 2. å…¥ç¤¾æ™‚ã®AWSæ©Ÿæ¢°å­¦ç¿’ç’°å¢ƒ

### 2.1. å…¥ç¤¾æ™‚ã®AWSæ©Ÿæ¢°å­¦ç¿’ç’°å¢ƒ: ECSä¸­å¿ƒã®æ§‹æˆ

<!-- å›³ã®æ§‹æˆæ¡ˆ:
- å·¦å´: ãƒ‡ãƒ¼ã‚¿ã‚µã‚¤ã‚¨ãƒ³ãƒ†ã‚£ã‚¹ãƒˆ (é–‹ç™ºè€…)
- å³å´: AWSæ§‹æˆ
  - GitHub Actions: Dockerã‚¤ãƒ¡ãƒ¼ã‚¸ãƒ“ãƒ«ãƒ‰ (5åˆ†)
  - Amazon ECR: ã‚³ãƒ³ãƒ†ãƒŠãƒ¬ã‚¸ã‚¹ãƒˆãƒª
  - Amazon ECS: æ©Ÿæ¢°å­¦ç¿’ã‚³ãƒ³ãƒ†ãƒŠå®Ÿè¡Œ (30-60åˆ†)
  - Amazon RDS: æ¨è«–çµæœä¿å­˜
  - Amazon S3: ãƒ‡ãƒ¼ã‚¿ä¿å­˜
  - Snowflake: å…±é€šãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹
  - CloudWatch Logs: ãƒ­ã‚°ç›£è¦–
- ãƒ•ãƒ­ãƒ¼: ã‚³ãƒ¼ãƒ‰ä½œæˆ â†’ GitHub push â†’ GitHub Actions â†’ ECR â†’ ECS â†’ RDS
- èª²é¡Œã‚’èµ¤æ–‡å­—ã§è¡¨ç¤º (.pyãƒ•ã‚¡ã‚¤ãƒ«å®Ÿè¡Œã§REPLãªã—ã€ãƒ“ãƒ«ãƒ‰5åˆ†ã€CloudWatchç¢ºèªãŒå¤§å¤‰)
-->

![Aws Ml Architecture image](/assets/2025-11-07-tamesare-data-sapporo-uma-chan/aws-ml-architecture.drawio.png)

### 2.2. é–‹ç™ºã§æ„Ÿã˜ãŸèª²é¡Œ

<!-- å›³ã®æ§‹æˆæ¡ˆ:

- 3ã¤ã®èª²é¡Œã‚’å¹ãå‡ºã—ã§è¡¨ç¾
  - (1) .pyãƒ•ã‚¡ã‚¤ãƒ«å®Ÿè¡Œã§REPLç’°å¢ƒãªã— (å¤‰æ•°ç¢ºèªãŒå›°é›£)
  - (2) ãƒ“ãƒ«ãƒ‰5åˆ† + ECSå®Ÿè¡Œ30-60åˆ† = æ§‹æ–‡ã‚¨ãƒ©ãƒ¼ã§ã‚‚15åˆ†ä»¥ä¸Šå¾…æ©Ÿ
  - (3) CloudWatch Logsã§ãƒ­ã‚°ç¢ºèªãŒé¢å€’
  - (4) ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ³ç”ŸãŒDocker/ECR/ECS/CloudWatch Logsç†è§£ã«æ™‚é–“ã‚’è²»ã‚„ã™
- ä¸­å¤®ã«å›°ã£ã¦ã„ã‚‹é–‹ç™ºè€…ã®ã‚¢ã‚¤ã‚³ãƒ³
- ã€Œ1æ—¥10å›ã®è©¦è¡ŒéŒ¯èª¤ã§2.5æ™‚é–“ãŒç„¡é§„ã€ã‚’å¼·èª¿
-->

![Aws Ml Challenges image](/assets/2025-11-07-tamesare-data-sapporo-uma-chan/aws-ml-challenges.drawio.png)

## 3. Databricksã¸ã®ç§»è¡Œ

### 3.1. ç§»è¡Œå¾Œ: Databricks ç’°å¢ƒã®æ§‹æˆ

<!-- å›³ã®æ§‹æˆæ¡ˆ:
- å·¦å´: ãƒ‡ãƒ¼ã‚¿ã‚µã‚¤ã‚¨ãƒ³ãƒ†ã‚£ã‚¹ãƒˆ (é–‹ç™ºè€…)
- å³å´: Databricks on AWSæ§‹æˆ
  - Databricks Workspace: Notebookç’°å¢ƒ (ã‚»ãƒ«å˜ä½ã§å³åº§å®Ÿè¡Œ)
  - Databricks Compute: è¨ˆç®—ãƒªã‚½ãƒ¼ã‚¹ (è‡ªå‹•èµ·å‹•/åœæ­¢)
  - Databricks Repos: GitHubé€£æº
  - Amazon S3: ãƒ‡ãƒ¼ã‚¿ä¿å­˜ (ãã®ã¾ã¾)
  - Amazon ECS: æœ¬ç•ªãƒ‡ãƒ—ãƒ­ã‚¤ (S3ãƒ•ã‚¡ã‚¤ãƒ«å‡ºåŠ›å¾Œ)
  - Snowflake: å…±é€šãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ (ãã®ã¾ã¾)
- ãƒ•ãƒ­ãƒ¼: Notebookä½œæˆ â†’ ã‚»ãƒ«å®Ÿè¡Œ â†’ ã‚­ãƒªã®è‰¯ã„ã¨ã“ã‚ã§GitHub push â†’ ãƒªãƒªãƒ¼ã‚¹å‰ã«ECSçµ±åˆãƒ†ã‚¹ãƒˆ
- æ”¹å–„ç‚¹ã‚’é’æ–‡å­—ã§è¡¨ç¤º (ã‚»ãƒ«å˜ä½å®Ÿè¡Œã€å¤‰æ•°çŠ¶æ…‹ä¿æŒã€çµæœå¯è¦–åŒ–ã€æ°—è»½ã«ã‚¸ãƒ§ãƒ–åŒ–)
-->

![Databricks Architecture image](/assets/2025-11-07-tamesare-data-sapporo-uma-chan/databricks-architecture.drawio.png)

### 3.2. AWSã‚µãƒ¼ãƒ“ã‚¹ã¨ã®å¯¾å¿œ

<!-- å›³ã®æ§‹æˆæ¡ˆ:
- 2åˆ—ã®å¯¾å¿œè¡¨å½¢å¼
  å·¦åˆ—: ç§»è¡Œå‰ â†’ ç§»è¡Œå¾Œ
  - .pyãƒ•ã‚¡ã‚¤ãƒ«å®Ÿè¡Œ â†’ Databricks Notebook (ã‚»ãƒ«å˜ä½å®Ÿè¡Œ)
  - Amazon ECS â†’ Databricks Compute (é–‹ç™º) + Amazon ECS (æœ¬ç•ª)
  - CloudWatch Logs â†’ Notebookå†…ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒ­ã‚°
  - IAM Role â†’ Instance Profile
  - Amazon S3 â†’ Amazon S3 (ãã®ã¾ã¾)
  - Snowflake â†’ Snowflake (ãã®ã¾ã¾)
  å³åˆ—: æ”¹å–„ãƒã‚¤ãƒ³ãƒˆ
  - REPLç’°å¢ƒã§å¤‰æ•°ç¢ºèªãƒ»çµæœå¯è¦–åŒ–
  - è‡ªå‹•èµ·å‹•/åœæ­¢ã§ã‚³ã‚¹ãƒˆå‰Šæ¸›
  - ã‚»ãƒ«å®Ÿè¡ŒçµæœãŒå³åº§ã«è¡¨ç¤º
  - æ—¢å­˜ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ãã®ã¾ã¾åˆ©ç”¨å¯èƒ½
-->

![Aws Databricks Mapping image](/assets/2025-11-07-tamesare-data-sapporo-uma-chan/aws-databricks-mapping.drawio.png)

## 4. å°å…¥åŠ¹æœ

### 4.1. é–‹ç™ºã‚µã‚¤ã‚¯ãƒ«ã®å¤‰åŒ–

<!-- å›³ã®æ§‹æˆæ¡ˆ:
- Before/Afteræ¯”è¼ƒ
- Before (ECS):
  - ã‚³ãƒ¼ãƒ‰ä½œæˆ â†’ GitHub push â†’ GitHub Actionsãƒ“ãƒ«ãƒ‰(5åˆ†) â†’ ECSã‚¿ã‚¹ã‚¯æ‰‹å‹•å®Ÿè¡Œ(30-60åˆ†) â†’ CloudWatch Logsç¢ºèª
  - æ§‹æ–‡ã‚¨ãƒ©ãƒ¼ç¨‹åº¦ã®ä¿®æ­£ã§ã‚‚15åˆ†ä»¥ä¸Šå¾…æ©Ÿ
- After (Databricks):
  - Notebookä½œæˆ â†’ ã‚»ãƒ«å®Ÿè¡Œ(æ•°ç§’) â†’ çµæœå³åº§è¡¨ç¤º
  - ã‚­ãƒªã®è‰¯ã„ã¨ã“ã‚ã§GitHub pushã€ãƒªãƒªãƒ¼ã‚¹å‰ã«ECSçµ±åˆãƒ†ã‚¹ãƒˆ
- ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³ã§æ™‚é–“ã®å·®ã‚’è¦–è¦šåŒ– (15åˆ†+ vs æ•°ç§’)
-->

![Development Cycle Comparison image](/assets/2025-11-07-tamesare-data-sapporo-uma-chan/development-cycle-comparison.drawio.png)

### 4.2. ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ³ç”Ÿã§ã‚‚ã™ãæ´»èº

<!-- å›³ã®æ§‹æˆæ¡ˆ:
- ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ³ç”Ÿã®ã‚¢ã‚¤ã‚³ãƒ³
- ç§»è¡Œå‰: å­¦ç¿’ãŒå¿…è¦ã ã£ãŸçŸ¥è­˜
  - Dockerã€Amazon ECRã€Amazon ECSã€CloudWatch Logsç†è§£ã«æ™‚é–“ã‚’è²»ã‚„ã™
  - ã€Œçµ±è¨ˆãƒ¢ãƒ‡ãƒªãƒ³ã‚°ã€ã«ç€æ‰‹ã™ã‚‹å‰ã®æº–å‚™ãŒé•·ã„
- ç§»è¡Œå¾Œ: å­¦ç¿’ã‚³ã‚¹ãƒˆå®Ÿè³ªã‚¼ãƒ­
  - ã‚³ãƒ³ãƒ†ãƒŠãƒ»IAMãƒ»CloudWatch Logsç†è§£ãŒä¸è¦ã«
  - æ—©æœŸã«æœ¬è³ªçš„æ¥­å‹™ (çµ±è¨ˆãƒ¢ãƒ‡ãƒªãƒ³ã‚°ã€æ©Ÿæ¢°å­¦ç¿’ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ è¨­è¨ˆ) ã«ç€æ‰‹å¯èƒ½
- å·¦â†’å³ã®çŸ¢å°ã§ã€ŒAWSã®å­¦ç¿’ã‚³ã‚¹ãƒˆãŒå®Ÿè³ªã‚¼ãƒ­ã«ã€ã‚’å¼·èª¿
-->

![Intern Productivity image](/assets/2025-11-07-tamesare-data-sapporo-uma-chan/intern-productivity.drawio.png)

### 4.3. å®šé‡çš„ãªæ”¹å–„åŠ¹æœ

<!-- å›³ã®æ§‹æˆæ¡ˆ:

- 3ã¤ã®æ”¹å–„ãƒã‚¤ãƒ³ãƒˆã‚’ã‚«ãƒ¼ãƒ‰å½¢å¼ã§è¡¨ç¤º
  - (1) é–‹ç™ºä½“é¨“ã®å¤§å¹…å‘ä¸Š
    - ã‚»ãƒ«å˜ä½å®Ÿè¡Œã€å¤‰æ•°çŠ¶æ…‹ä¿æŒã€çµæœå¯è¦–åŒ–
  - (2) AWSã®å­¦ç¿’ã‚³ã‚¹ãƒˆå®Ÿè³ªã‚¼ãƒ­
    - ã‚³ãƒ³ãƒ†ãƒŠãƒ»IAMãƒ»CloudWatch Logsç†è§£ãŒä¸è¦
  - (3) æ°—è»½ã«ã‚¸ãƒ§ãƒ–åŒ–
    - æœ¬ç•ªé‹ç”¨ã¸ã®ç§»è¡ŒãŒã‚¹ãƒ ãƒ¼ã‚º
- ä¸­å¤®ã«ä¸‹å‘ãçŸ¢å°ã§ã€Œå­¦ç¿’ã‚³ã‚¹ãƒˆãŒå®Ÿè³ªã‚¼ãƒ­ã«ã€ã‚’å¼·èª¿
- çŸ¢å°ã¯ã€Œç§»è¡Œå‰ (Docker/ECR/ECS/CloudWatch Logs)ã€ã‹ã‚‰ã€Œç§»è¡Œå¾Œ (ä¸è¦)ã€ã«å‘ã‘ã‚‹
-->

![Quantitative Improvement image](/assets/2025-11-07-tamesare-data-sapporo-uma-chan/quantitative-improvement.drawio.png)

### 4.4. ã»ã¼ã‚¼ãƒ­ã‚³ã‚¹ãƒˆã§æœ¬ç•ªé‹ç”¨

<!-- å›³ã®æ§‹æˆæ¡ˆ:
- å·¦å´: é–‹ç™ºãƒ•ãƒ­ãƒ¼
  - Notebook ã§ã‚»ãƒ«å®Ÿè¡Œ
  - ãƒ‡ãƒãƒƒã‚°ãƒ»èª¿æ•´
  - å®Œæˆ
- ä¸­å¤®: ãƒ¯ãƒ³ã‚¯ãƒªãƒƒã‚¯å¤‰æ›ã®çŸ¢å°
  - ã€Œãƒ¯ãƒ³ã‚¯ãƒªãƒƒã‚¯ã§ã‚¸ãƒ§ãƒ–åŒ–!ã€ã‚’å¼·èª¿
- å³å´: æœ¬ç•ªé‹ç”¨ãƒ•ãƒ­ãƒ¼
  - Databricks Jobs ã¨ã—ã¦è‡ªå‹•å®Ÿè¡Œ
  - ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«å®Ÿè¡Œ
  - ã‚¨ãƒ©ãƒ¼é€šçŸ¥
- ãƒã‚¤ãƒ³ãƒˆ:
  - é–‹ç™ºã¨é‹ç”¨ãŒå…¨ãåŒã˜ã‚³ãƒ¼ãƒ‰
  - ãƒ‡ãƒ—ãƒ­ã‚¤ä½œæ¥­ä¸è¦
  - é‹ç”¨ã‚³ã‚¹ãƒˆã»ã¼ã‚¼ãƒ­
-->

![Job Migration image](/assets/2025-11-07-tamesare-data-sapporo-uma-chan/job-migration.drawio.png)

## 5. ã¾ã¨ã‚

### 5.1. Databricks on AWS ã§ã¯ AWS ã®çŸ¥è¦‹ãŒãã®ã¾ã¾æ´»ãã‚‹

- S3 / EC2 / IAM Role ãªã©ã€æ—¢å­˜ã® AWS çŸ¥è­˜ãŒæ´»ç”¨ã§ãã‚‹
- AWS æ§‹æˆã‹ã‚‰ã®ç§»è¡ŒãŒã‚¹ãƒ ãƒ¼ã‚º
- ã‚¤ãƒ³ãƒ•ãƒ©ã¯ AWS ã®ã¾ã¾ã€é–‹ç™ºä½“é¨“ãŒåŠ‡çš„ã«å‘ä¸Š
    - AWS åˆ†ã‹ã‚‹äººãŒ1äººã§ã‚‚ã„ã‚Œã°å¤§ä½“ä½•ã¨ã‹ãªã‚‹

### 5.2. ä½µã›ã¦ã“ã¡ã‚‰ã‚‚ã”ç¢ºèªãã ã•ã„

::: {style="display: flex; align-items: center; gap: 3em; margin-top: 2em;"}

::: {style="flex: 1;"}
[![Zenn Twitter Card image](/assets/2025-11-07-tamesare-data-sapporo-uma-chan/zenn-twitter-card.jpeg){width="100%"}](https://zenn.dev/genda_jp/articles/724a597e8f18ff)
:::

::: {style="flex: 1; text-align: left;"}

**GENDAã®ãƒ‡ãƒ¼ã‚¿ã‚µã‚¤ã‚¨ãƒ³ãƒ†ã‚£ã‚¹ãƒˆé–‹ç™ºä½“é¨“å‘ä¸Šã®å–ã‚Šçµ„ã¿ç´¹ä»‹**

AWS ECSã‹ã‚‰Databricksã¸ã®ç§»è¡Œ

[https://zenn.dev/genda_jp/articles/724a597e8f18ff](https://zenn.dev/genda_jp/articles/724a597e8f18ff)

:::

:::
